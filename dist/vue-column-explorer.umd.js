(function(V,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue"),require("lucide-vue-next")):typeof define=="function"&&define.amd?define(["exports","vue","lucide-vue-next"],e):(V=typeof globalThis<"u"?globalThis:V||self,e(V.VueColumnExplorer={},V.Vue,V.LucideVueNext))})(this,function(V,e,g){"use strict";function W(t){const f=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const o in t)if(o!=="default"){const d=Object.getOwnPropertyDescriptor(t,o);Object.defineProperty(f,o,d.get?d:{enumerable:!0,get:()=>t[o]})}}return f.default=t,Object.freeze(f)}const q=W(g);function L(t){const f=e.reactive(new Map),o=e.ref(-1),d=e.ref([]),m=e.ref({}),p=e.ref({appearance:{columnWidth:300,maxVisibleColumns:4,animationDuration:200,theme:"light"},behavior:{clickBehavior:"single",selectionPersistence:!1,autoLoadNextPage:!0,scrollBehavior:"smooth"},performance:{itemsPerPage:50,virtualScrollThreshold:100,maxConcurrentRequests:2,requestTimeout:1e4}}),b=e.computed(()=>{const n=[];for(let r=0;r<=o.value;r++){const a=f.get(r);a&&n.push(a)}return n}),y=e.computed(()=>{const n=f.get(o.value);return(n==null?void 0:n.selectedIds)||new Set}),_=e.computed(()=>{const n=f.get(o.value);return!!(n&&n.selectedIds.size>0)}),N=e.computed(()=>{const n=[];for(let c=0;c<=o.value;c++){const u=f.get(c);if(u){const s=u.items.find(C=>u.selectedIds.has(C.id));n.push({columnId:u.config.id,selectedItem:s||null,selectedIds:new Set(u.selectedIds)})}}const r=o.value>0?f.get(o.value-1):null,a=r?r.items.find(c=>r.selectedIds.has(c.id)):null,h=f.get(o.value),l=h?h.items.filter(c=>h.selectedIds.has(c.id)):[];return{parentId:(a==null?void 0:a.id)||null,parentItem:a||null,breadcrumb:d.value,globalFilters:m.value,columnChain:n,selectedItems:l,external:t,getParentData(c){const u=o.value-c;return n[u]},getColumnData(c){return n.find(u=>u.columnId===c)}}});function E(n){p.value={appearance:{...p.value.appearance,...n.appearance},behavior:{...p.value.behavior,...n.behavior},performance:{...p.value.performance,...n.performance}}}async function S(n,r){const a=r??o.value+1;for(let l=f.size-1;l>a;l--)f.delete(l);const h={config:e.markRaw(n),items:[],selectedIds:new Set,page:0,hasMore:!0,isLoading:!1,error:null,filters:{}};f.set(a,h),o.value=a,a===0&&(d.value=[{columnId:n.id,columnName:n.name}]),await w(a)}async function w(n,r=0){const a=f.get(n);if(a){a.isLoading=!0,a.error=null,r===0&&(a.items=[]);try{const h=N.value,l=await a.config.dataProvider.fetch({parentId:h.parentId,page:r,filters:{...m.value,...a.filters,...a.currentSort?{sort:a.currentSort}:{}},context:h});let c=l.items;if(a.currentSort&&a.config.sortOptions){const u=a.config.sortOptions.find(s=>s.key===a.currentSort);u&&u.sortFn&&(c=[...c].sort(u.sortFn))}r===0?a.items=c:a.items.push(...c),a.hasMore=l.hasMore,a.page=r}catch(h){a.error=h,console.error("Error loading column data:",h)}finally{a.isLoading=!1}}}async function M(n){const r=f.get(n);!r||!r.hasMore||r.isLoading||await w(n,r.page+1)}async function $(n){const r=f.get(n);r&&(r.selectedIds=new Set,r.page=0,await w(n,0))}function T(n,r,a=!1){var l;const h=f.get(n);if(!(!h||!((l=h.config.selection)!=null&&l.enabled)))if(a&&h.config.selection.multiple){const c=new Set(h.selectedIds);c.has(r)?c.delete(r):c.add(r),h.selectedIds=c}else h.selectedIds=new Set([r])}function D(n){const r=f.get(n);r&&(r.selectedIds=new Set)}async function x(n,r){var c,u,s;const a=f.get(r);if(!a||!a.config.itemClick)return;const h=N.value,l=await((u=(c=a.config.itemClick).handler)==null?void 0:u.call(c,n,h));if(l!=null&&l.column)d.value=d.value.slice(0,r+1),await S(e.markRaw(l.column),r+1),d.value.push({columnId:l.column.id,columnName:n.name,itemId:n.id,itemName:n.name});else if(l!=null&&l.action){const C=(s=a.config.actions)==null?void 0:s.find(i=>i.key===l.action);C&&await F(r,C.key)}else l!=null&&l.custom&&l.custom()}async function F(n,r){var c;const a=f.get(n);if(!a)return;const h=(c=a.config.actions)==null?void 0:c.find(u=>u.key===r);if(!h)return;const l=Array.from(a.selectedIds);if(l.length!==0)try{const u=N.value;await h.handler(l,u),console.log("[executeAction] skipRefresh:",h.skipRefresh,"actionKey:",r),h.skipRefresh?console.log("[executeAction] Skipping refresh for column",n):(console.log("[executeAction] Refreshing column",n),await $(n))}catch(u){console.error("Error executing action:",u)}}function P(n){for(let r=f.size-1;r>n;r--)f.delete(r);o.value=n,d.value=d.value.slice(0,n+1)}function j(n,r,a){const h=f.get(n);h&&(a==null||a===""?delete h.filters[r]:h.filters[r]=a,w(n,0))}function O(n,r){const a=f.get(n);a&&(r==null||r===""?a.currentSort=void 0:a.currentSort=r,w(n,0))}return{columns:f,activeColumnIndex:o,breadcrumb:d,globalFilters:m,config:p,visibleColumns:b,currentSelection:y,canNavigateForward:_,getContext:N,setConfig:E,openColumn:S,loadColumnData:w,loadNextPage:M,refreshColumn:$,selectItem:T,clearSelection:D,navigateToItem:x,executeAction:F,navigateToBreadcrumb:P,setFilter:j,setSort:O}}const H={class:"explorer-breadcrumb"},G=["onClick"],X=e.defineComponent({__name:"ExplorerBreadcrumb",props:{breadcrumb:{}},emits:["navigate"],setup(t,{emit:f}){const o=f,d=m=>{o("navigate",m)};return(m,p)=>(e.openBlock(),e.createElementBlock("div",H,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.breadcrumb,(b,y)=>(e.openBlock(),e.createElementBlock("div",{key:y,class:"breadcrumb-item"},[e.createElementVNode("button",{class:e.normalizeClass(["breadcrumb-item__button",{"breadcrumb-item__button--active":y===t.breadcrumb.length-1}]),onClick:_=>d(y)},e.toDisplayString(b.itemName||b.columnName),11,G),y<t.breadcrumb.length-1?(e.openBlock(),e.createBlock(e.unref(g.ChevronRight),{key:0,size:16,class:"breadcrumb-separator"})):e.createCommentVNode("",!0)]))),128))]))}}),R=(t,f)=>{const o=t.__vccOpts||t;for(const[d,m]of f)o[d]=m;return o},Y=R(X,[["__scopeId","data-v-27ca8931"]]),J={key:0,class:"explorer-item__checkbox"},Q=["checked"],Z={class:"explorer-item__content"},K={key:0,class:"explorer-item__icon"},v={class:"explorer-item__details"},ee={class:"explorer-item__name"},te={key:0,class:"explorer-item__metadata"},oe={key:1,class:"explorer-item__chevron"},le={key:1,class:"item-status"},ne={key:2,class:"item-count"},ce=R(e.defineComponent({__name:"ExplorerItem",props:{item:{},selected:{type:Boolean,default:!1},selectable:{type:Boolean,default:!1},clickable:{type:Boolean,default:!0},showIcon:{type:Boolean,default:!0},showMetadata:{type:Boolean,default:!0}},emits:["click","dblclick","contextmenu","select"],setup(t,{emit:f}){const o=t,d=f,m=e.computed(()=>{if(!o.item.icon)return o.item.type==="folder"?q.Folder:q.File;if(o.item.icon.startsWith("lucide:")){const w=o.item.icon.replace("lucide:","").split("-").map($=>$.charAt(0).toUpperCase()+$.slice(1)).join(""),M=q[w];if(M)return M}return q.File}),p=e.computed(()=>{const S=o.item.badgeColor;return S&&["success","error","warning","info"].includes(S.toLowerCase())?`item-badge--${S.toLowerCase()}`:""}),b=e.computed(()=>{const S=o.item.badgeColor;return S?["success","error","warning","info"].includes(S.toLowerCase())?{}:{backgroundColor:S,color:"#ffffff"}:{}}),y=S=>{o.clickable&&!o.item.disabled&&d("click",o.item,S)},_=S=>{d("dblclick",o.item,S)},N=S=>{d("contextmenu",o.item,S)},E=S=>{d("select",o.item,!0)};return(S,w)=>{const M=e.resolveComponent("ChevronRight");return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["explorer-item",{"explorer-item--selected":t.selected,"explorer-item--clickable":t.clickable&&!t.item.disabled,"explorer-item--disabled":t.item.disabled}]),onClick:y,onDblclick:_,onContextmenu:e.withModifiers(N,["prevent"])},[t.selectable?(e.openBlock(),e.createElementBlock("div",J,[e.createElementVNode("input",{type:"checkbox",checked:t.selected,onClick:e.withModifiers(E,["stop"])},null,8,Q)])):e.createCommentVNode("",!0),e.createElementVNode("div",Z,[t.showIcon?(e.openBlock(),e.createElementBlock("div",K,[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(m.value),{size:20}))])):e.createCommentVNode("",!0),e.createElementVNode("div",v,[e.createElementVNode("div",ee,e.toDisplayString(t.item.name),1),t.showMetadata&&t.item.description?(e.openBlock(),e.createElementBlock("div",te,e.toDisplayString(t.item.description),1)):e.createCommentVNode("",!0)])]),t.item.badge!==void 0||t.item.status!==void 0||t.item.count!==void 0||t.item.hasChildren?(e.openBlock(),e.createElementBlock("div",oe,[t.item.badge!==void 0?(e.openBlock(),e.createElementBlock("span",{key:0,class:e.normalizeClass(["item-badge",p.value]),style:e.normalizeStyle(b.value)},e.toDisplayString(t.item.badge),7)):t.item.status!==void 0?(e.openBlock(),e.createElementBlock("span",le,e.toDisplayString(t.item.status),1)):t.item.count!==void 0?(e.openBlock(),e.createElementBlock("span",ne,e.toDisplayString(t.item.count),1)):e.createCommentVNode("",!0),t.item.hasChildren?(e.openBlock(),e.createBlock(M,{key:3,size:16})):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0)],34)}}}),[["__scopeId","data-v-ed186481"]]),ae={key:0,class:"explorer-column explorer-column--detail"},re={class:"detail-view"},ie={class:"detail-view__header"},se={class:"detail-view__icon"},de={class:"detail-view__content"},me={class:"detail-view__title"},ue={key:0,class:"detail-view__description"},fe={key:0,class:"detail-view__actions"},he=["onClick"],ke={class:"explorer-column__header"},pe={class:"explorer-column__title"},ge={class:"explorer-column__actions"},Ce={key:0,class:"explorer-column__filters"},ye={key:0,class:"filter-item"},Se=["value"],be=["value"],Be={class:"filter-item__label"},_e=["placeholder","value","onInput"],we=["placeholder","value","onInput"],xe=["value","onChange"],Ee=["value"],Ne={key:0,class:"explorer-column__loading"},Ve={key:1,class:"explorer-column__error"},Me={key:0,class:"error-message"},$e={key:2,class:"explorer-column__empty"},De={key:3,class:"explorer-column__items"},Ie={key:0,class:"explorer-column__loading-more"},Fe={key:1,class:"explorer-column__footer"},Oe={class:"explorer-column__selection-info"},Ae={class:"explorer-column__quick-actions"},ze=["onClick"],Re=R(e.defineComponent({__name:"ExplorerColumn",props:{columnState:{},index:{},isActive:{type:Boolean}},emits:["item-click","item-select","context-menu","refresh","load-more","action","filter-change","sort-change"],setup(t,{emit:f}){const o=t,d=f,m=e.ref(null),p=e.ref(!1),b=e.computed(()=>o.columnState.config.filters&&o.columnState.config.filters.length>0),y=e.computed(()=>o.columnState.config.sortOptions&&o.columnState.config.sortOptions.length>0),_=e.computed(()=>o.columnState.selectedIds.size>0),N=e.computed(()=>{var l;return((l=o.columnState.config.view)==null?void 0:l.loadingRows)||10}),E=e.computed(()=>{var l;return((l=o.columnState.config.view)==null?void 0:l.emptyMessage)||"No items found"}),S=e.computed(()=>o.columnState.isLoading&&o.columnState.items.length===0),w=e.computed(()=>{if(!o.columnState.config.actions)return[];const l=o.columnState.items.filter(u=>o.columnState.selectedIds.has(u.id)),c=l.length;return o.columnState.config.actions.filter(u=>c===1&&u.showOnSingleSelect===!1||c>1&&u.showOnMultipleSelect===!1||c===1&&u.showOnMultipleSelect===!0&&u.showOnSingleSelect===!1||c>1&&u.showOnSingleSelect===!0&&u.showOnMultipleSelect===!1?!1:u.visible?u.visible(l):!0)}),M=e.computed(()=>{const l=Object.keys(o.columnState.filters).some(u=>{const s=o.columnState.filters[u];return s!=null&&s!==""}),c=o.columnState.currentSort!==null&&o.columnState.currentSort!==void 0&&o.columnState.currentSort!=="";return l||c}),$=()=>{p.value=!p.value},T=(l,c)=>{d("item-click",l,o.index)},D=(l,c)=>{d("item-select",l,o.index,c)},x=(l,c)=>{d("context-menu",l,o.index,c)},F=()=>{d("refresh",o.index)},P=()=>{if(!m.value)return;const{scrollTop:l,scrollHeight:c,clientHeight:u}=m.value;l+u>=c-100&&o.columnState.hasMore&&!o.columnState.isLoading&&d("load-more",o.index)},j=l=>{d("action",l,o.index)},O=(l,c)=>{d("filter-change",l,c,o.index)},n=l=>{d("sort-change",l,o.index)},r=l=>({"lucide:trash":g.Trash,"lucide:download":g.Download,"lucide:edit":g.Edit,"lucide:mail":g.Mail})[l]||null,a=l=>({"lucide:file":g.File,"lucide:folder":g.Folder,"lucide:user":g.User,"lucide:file-text":g.FileText,"lucide:book":g.Book,"lucide:clipboard":g.Clipboard,"lucide:globe":g.Globe,"lucide:file-badge":g.FileBadge,"lucide:file-check":g.FileCheck,"lucide:file-spreadsheet":g.FileSpreadsheet,"lucide:download":g.Download,"lucide:trash":g.Trash,"lucide:edit":g.Edit,"lucide:mail":g.Mail})[l]||g.File,h=l=>{d("action",l,o.index)};return(l,c)=>{var u,s,C;return t.columnState.config.isDetailView?(e.openBlock(),e.createElementBlock("div",ae,[e.createElementVNode("div",re,[e.createElementVNode("div",ie,[e.createElementVNode("div",se,[(u=t.columnState.config.detailItem)!=null&&u.icon?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(a(t.columnState.config.detailItem.icon)),{key:0,size:48,"stroke-width":1.5})):e.createCommentVNode("",!0)])]),e.createElementVNode("div",de,[e.createElementVNode("h3",me,e.toDisplayString((s=t.columnState.config.detailItem)==null?void 0:s.name),1),(C=t.columnState.config.detailItem)!=null&&C.description?(e.openBlock(),e.createElementBlock("p",ue,e.toDisplayString(t.columnState.config.detailItem.description),1)):e.createCommentVNode("",!0)]),w.value.length>0?(e.openBlock(),e.createElementBlock("div",fe,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(w.value,i=>(e.openBlock(),e.createElementBlock("button",{key:i.key,class:e.normalizeClass(["detail-view__action-btn",[`detail-view__action-btn--${i.color||"default"}`]]),onClick:k=>h(i.key)},[i.icon?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(a(i.icon)),{key:0,size:18,"stroke-width":2})):e.createCommentVNode("",!0),e.createElementVNode("span",null,e.toDisplayString(i.label),1)],10,he))),128))])):e.createCommentVNode("",!0)])])):(e.openBlock(),e.createElementBlock("div",{key:1,class:e.normalizeClass(["explorer-column",{"explorer-column--active":t.isActive}])},[e.createElementVNode("div",ke,[e.createElementVNode("h3",pe,e.toDisplayString(t.columnState.config.name),1),e.createElementVNode("div",ge,[b.value||y.value?(e.openBlock(),e.createElementBlock("button",{key:0,class:e.normalizeClass(["explorer-column__filter-btn",{active:p.value,"has-active-filters":M.value}]),onClick:$},[e.createVNode(e.unref(g.Filter),{size:16})],2)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"explorer-column__refresh-btn",onClick:F},[e.createVNode(e.unref(g.RefreshCw),{size:16})])])]),p.value&&(b.value||y.value)?(e.openBlock(),e.createElementBlock("div",Ce,[y.value?(e.openBlock(),e.createElementBlock("div",ye,[c[2]||(c[2]=e.createElementVNode("label",{class:"filter-item__label"},"Sıralama",-1)),e.createElementVNode("select",{class:"filter-item__select",value:t.columnState.currentSort||"",onChange:c[0]||(c[0]=i=>n(i.target.value))},[c[1]||(c[1]=e.createElementVNode("option",{value:""},"Varsayılan",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.columnState.config.sortOptions,i=>(e.openBlock(),e.createElementBlock("option",{key:i.key,value:i.key},e.toDisplayString(i.label),9,be))),128))],40,Se)])):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.columnState.config.filters,i=>(e.openBlock(),e.createElementBlock("div",{key:i.key,class:"filter-item"},[e.createElementVNode("label",Be,e.toDisplayString(i.label),1),i.type==="search"?(e.openBlock(),e.createElementBlock("input",{key:0,type:"text",class:"filter-item__input",placeholder:`Search ${i.label.toLowerCase()}...`,value:t.columnState.filters[i.key]||"",onInput:k=>O(i.key,k.target.value)},null,40,_e)):i.type==="number"?(e.openBlock(),e.createElementBlock("input",{key:1,type:"number",class:"filter-item__input",placeholder:i.label,value:t.columnState.filters[i.key]||"",onInput:k=>O(i.key,k.target.value)},null,40,we)):i.type==="select"?(e.openBlock(),e.createElementBlock("select",{key:2,class:"filter-item__select",value:t.columnState.filters[i.key]||"",onChange:k=>O(i.key,k.target.value)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.options,k=>(e.openBlock(),e.createElementBlock("option",{key:k.value,value:k.value},e.toDisplayString(k.label),9,Ee))),128))],40,xe)):e.createCommentVNode("",!0)]))),128))])):e.createCommentVNode("",!0),e.createElementVNode("div",{ref_key:"scrollContainer",ref:m,class:"explorer-column__content",onScroll:P},[S.value?(e.openBlock(),e.createElementBlock("div",Ne,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(N.value,i=>(e.openBlock(),e.createElementBlock("div",{key:i,class:"skeleton-item"},[...c[3]||(c[3]=[e.createStaticVNode('<div class="skeleton-item__icon" data-v-9b3a2381></div><div class="skeleton-item__content" data-v-9b3a2381><div class="skeleton-item__name" data-v-9b3a2381></div><div class="skeleton-item__metadata" data-v-9b3a2381></div></div><div class="skeleton-item__chevron" data-v-9b3a2381></div>',3)])]))),128))])):t.columnState.error?(e.openBlock(),e.createElementBlock("div",Ve,[c[4]||(c[4]=e.createElementVNode("p",null,"Error loading data",-1)),t.columnState.error.message?(e.openBlock(),e.createElementBlock("p",Me,e.toDisplayString(t.columnState.error.message),1)):e.createCommentVNode("",!0),e.createElementVNode("button",{onClick:F},"Retry")])):t.columnState.items.length===0&&!t.columnState.isLoading?(e.openBlock(),e.createElementBlock("div",$e,e.toDisplayString(E.value),1)):t.columnState.items.length>0?(e.openBlock(),e.createElementBlock("div",De,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.columnState.items,i=>{var k,I,A;return e.openBlock(),e.createBlock(ce,{key:i.id,item:i,selected:t.columnState.selectedIds.has(i.id),selectable:((k=t.columnState.config.selection)==null?void 0:k.multiple)??!1,clickable:!0,"show-icon":((I=t.columnState.config.view)==null?void 0:I.showIcon)??!0,"show-metadata":((A=t.columnState.config.view)==null?void 0:A.showMetadata)??!0,onClick:(B,z)=>T(B),onSelect:(B,z)=>D(B,z),onContextmenu:(B,z)=>x(B,z)},null,8,["item","selected","selectable","show-icon","show-metadata","onClick","onSelect","onContextmenu"])}),128)),t.columnState.isLoading&&t.columnState.items.length>0?(e.openBlock(),e.createElementBlock("div",Ie," Loading more... ")):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0)],544),_.value&&!t.columnState.config.isDetailView?(e.openBlock(),e.createElementBlock("div",Fe,[e.createElementVNode("div",Oe,e.toDisplayString(t.columnState.selectedIds.size)+" selected ",1),e.createElementVNode("div",Ae,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(w.value,i=>(e.openBlock(),e.createElementBlock("button",{key:i.key,class:e.normalizeClass(["action-btn",`action-btn--${i.color||"default"}`]),onClick:k=>j(i.key)},[i.icon?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(r(i.icon)),{key:0,size:14})):e.createCommentVNode("",!0),e.createTextVNode(" "+e.toDisplayString(i.label),1)],10,ze))),128))])])):e.createCommentVNode("",!0)],2))}}}),[["__scopeId","data-v-9b3a2381"]]),Te=["onClick"],Pe=R(e.defineComponent({__name:"ExplorerContextMenu",props:{visible:{type:Boolean},x:{},y:{},actions:{}},emits:["close","action"],setup(t,{emit:f}){const o=t,d=f,m=()=>{d("close")},p=_=>{d("action",_.key),d("close")},b=_=>({"lucide:download":g.Download,"lucide:trash":g.Trash,"lucide:edit":g.Edit,"lucide:eye":g.Eye})[_]||null,y=()=>{o.visible&&d("close")};return e.onMounted(()=>{document.addEventListener("click",y)}),e.onUnmounted(()=>{document.removeEventListener("click",y)}),(_,N)=>(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[t.visible?(e.openBlock(),e.createElementBlock("div",{key:0,class:"context-menu",style:e.normalizeStyle({top:`${t.y}px`,left:`${t.x}px`}),onClick:m},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.actions,E=>(e.openBlock(),e.createElementBlock("div",{key:E.key,class:"context-menu__item",onClick:S=>p(E)},[E.icon?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(b(E.icon)),{key:0,size:16})):e.createCommentVNode("",!0),e.createElementVNode("span",null,e.toDisplayString(E.label),1)],8,Te))),128))],4)):e.createCommentVNode("",!0)]))}}),[["__scopeId","data-v-569d2f59"]]),je={class:"explorer-container"},qe={class:"explorer-main"},U=R(e.defineComponent({__name:"ExplorerContainer",props:{rootColumn:{},context:{}},setup(t,{expose:f}){const o=t,d=L(o.context),{breadcrumb:m,visibleColumns:p,activeColumnIndex:b,openColumn:y,selectItem:_,navigateToItem:N,navigateToBreadcrumb:E,refreshColumn:S,loadNextPage:w,executeAction:M,setFilter:$,setSort:T}=d,D=e.ref(null),x=e.reactive({visible:!1,x:0,y:0,actions:[],targetItem:null,targetColumnIndex:-1});e.watch(b,async()=>{await e.nextTick(),requestAnimationFrame(()=>{D.value&&D.value.scrollTo({left:D.value.scrollWidth,behavior:"smooth"})})},{flush:"post"}),o.rootColumn&&y(o.rootColumn,0);const F=async(s,C)=>{var k;if(_(C,s.id,!1),s.show){const I=d.columns.get(C);if(!I)return;const A={id:`detail-${s.id}`,name:s.name,isDetailView:!0,detailItem:s,dataProvider:{fetch:async()=>({items:[s],hasMore:!1})},selection:{enabled:!0,multiple:!1},actions:((k=I.config.actions)==null?void 0:k.filter(B=>B.showOnSingleSelect===!0))||[]};await y(A,C+1),_(C+1,s.id,!1);return}const i=d.columns.get(C);i!=null&&i.config.itemClick&&await N(s,C)},P=(s,C,i)=>{_(C,s.id,i)},j=(s,C,i)=>{const k=d.columns.get(C);if(!(k!=null&&k.config.actions)||k.config.actions.length===0)return;k.selectedIds.has(s.id)||_(C,s.id,!1);const I=k.selectedIds.size,A=k.config.actions.filter(B=>{if(I===1){if(B.showOnSingleSelect!==void 0&&!B.showOnSingleSelect||B.showOnMultipleSelect===!0&&B.showOnSingleSelect!==void 0&&!B.showOnSingleSelect)return!1}else if(I>1&&(B.showOnMultipleSelect!==void 0&&!B.showOnMultipleSelect||B.showOnSingleSelect===!0&&B.showOnMultipleSelect!==void 0&&!B.showOnMultipleSelect))return!1;const z=k.items.filter(We=>k.selectedIds.has(We.id));return!(B.visible&&!B.visible(z))});A.length!==0&&(x.visible=!0,x.x=i.clientX,x.y=i.clientY,x.actions=A,x.targetItem=s,x.targetColumnIndex=C)},O=()=>{x.visible=!1},n=async s=>{x.targetColumnIndex>=0&&await M(x.targetColumnIndex,s)},r=s=>{E(s)},a=async s=>{await S(s)},h=async s=>{await w(s)},l=async(s,C)=>{await M(C,s)},c=(s,C,i)=>{$(i,s,C)},u=(s,C)=>{T(C,s)};return f({store:d,openColumn:s=>y(s),refresh:()=>S(b.value)}),(s,C)=>(e.openBlock(),e.createElementBlock("div",je,[e.unref(m).length>0?(e.openBlock(),e.createBlock(Y,{key:0,breadcrumb:e.unref(m),onNavigate:r},null,8,["breadcrumb"])):e.createCommentVNode("",!0),e.createElementVNode("div",qe,[e.createElementVNode("div",{ref_key:"viewportRef",ref:D,class:"explorer-viewport"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(p),(i,k)=>(e.openBlock(),e.createBlock(Re,{key:k,"column-state":i,index:k,"is-active":k===e.unref(b),onItemClick:F,onItemSelect:P,onContextMenu:j,onRefresh:a,onLoadMore:h,onAction:l,onFilterChange:c,onSortChange:u},null,8,["column-state","index","is-active"]))),128))],512)]),e.createVNode(Pe,{visible:x.visible,x:x.x,y:x.y,actions:x.actions,onClose:O,onAction:n},null,8,["visible","x","y","actions"])]))}}),[["__scopeId","data-v-c92ba803"]]);function Le(t){var f,o,d;return{id:t.id,name:t.name,dataProvider:{fetch:async m=>{if(console.log(`[ColumnBuilder-${t.id}] fetch called with params:`,m),console.log(`[ColumnBuilder-${t.id}] config.data:`,t.data),console.log(`[ColumnBuilder-${t.id}] config.fetchData:`,typeof t.fetchData),t.data)return console.log(`[ColumnBuilder-${t.id}] Using static data`),{items:Array.isArray(t.data)?t.data:[],hasMore:!1};if(t.fetchData){console.log(`[ColumnBuilder-${t.id}] Calling fetchData...`);try{const p=await t.fetchData(m);return console.log(`[ColumnBuilder-${t.id}] fetchData returned:`,p),{items:Array.isArray(p)?p:[],hasMore:!1}}catch(p){throw console.error(`[ColumnBuilder-${t.id}] Error in fetchData:`,p),p}}return console.warn(`[ColumnBuilder-${t.id}] No data source provided!`),{items:[],hasMore:!1}}},selection:{enabled:t.allowMultipleSelection!==void 0||!!(t.singleActions&&t.singleActions.length>0)||!!(t.multipleActions&&t.multipleActions.length>0)||!!t.onItemClick,multiple:t.allowMultipleSelection!==void 0?t.allowMultipleSelection:!1},filters:(f=t.filters)==null?void 0:f.map(m=>({...m,default:void 0})),sortOptions:t.sortOptions,actions:[...((o=t.singleActions)==null?void 0:o.map(m=>({key:m.key,label:m.label,icon:m.icon,color:m.color,skipRefresh:m.skipRefresh,showOnSingleSelect:!0,showOnMultipleSelect:!1,handler:async(p,b)=>{var _;const y=(_=b.selectedItems)==null?void 0:_[0];if(!y){console.warn(`[ColumnBuilder-${t.id}] No item found for single action: ${m.key}`);return}await m.handler(y,b)}})))||[],...((d=t.multipleActions)==null?void 0:d.map(m=>({key:m.key,label:m.label,icon:m.icon,color:m.color,skipRefresh:m.skipRefresh,showOnSingleSelect:!1,showOnMultipleSelect:!0,handler:async(p,b)=>{const y=b.selectedItems||[];if(y.length===0){console.warn(`[ColumnBuilder-${t.id}] No items found for multiple action: ${m.key}`);return}await m.handler(y,b)}})))||[]],itemClick:t.onItemClick?{type:"navigate",handler:async(m,p)=>{const b=await t.onItemClick(m,p);return b?{column:b}:{}}}:void 0,view:{showIcon:!0,showMetadata:!0,emptyMessage:`No ${t.name.toLowerCase()} found`}}}const Ue={install(t){t.component("ExplorerContainer",U)}};V.ExplorerContainer=U,V.createColumn=Le,V.default=Ue,V.useExplorer=L,Object.defineProperties(V,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
